<header class="site-header">
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container-fluid">
      {%- assign default_paths = site.pages | map: "path" -%}
      {%- assign page_paths = site.header_pages | default: default_paths -%}
      {%- assign titles_size = site.pages | map: 'title' | join: '' | size -%}
      
      <a class="navbar-brand fw-bold" href="
        {% if jekyll.environment == 'production' and page.language == 'en' %}
            {{ "/converter" | prepend: site.production.baseurl }}
          {% elsif jekyll.environment == 'production' and page.language == 'cs' %}
            {{ "/cs/converter" | prepend: site.production.baseurl }}
          {% elsif page.language == 'en' %}
            {{ "/converter" | prepend: site.development.baseurl }}
          {% else %}
            {{ "/cs/converter" | prepend: site.development.baseurl }}
        {% endif %}">
        {{ site.title | escape }}
      </a>

      {%- if titles_size > 0 -%}
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            {% for p in site.pages %}
              {% if p.language == page.language %} 
                {% if p.redirect_to == nil %}
                  <li class="nav-item">
                    <a class="nav-link" href="{% if jekyll.environment == 'production' %}{{ p.url | prepend: site.production.baseurl }}{% else %}{{ p.url | prepend: site.development.baseurl }}{% endif %}">
                      {{ p.title }}
                    </a>
                  </li>
                {% endif %}
              {% endif %}
            {% endfor %}
          </ul>
          
          <div class="d-flex gap-2">
            {% if page.name contains "index" %}
              <a class="btn btn-outline-primary btn-sm" href="{% if jekyll.environment == 'production' %}{{ site.production.baseurl }}{% else %}{{ site.development.baseurl }}{% endif %}/">
                <span class="fi fi-gb"></span>
                <span class="fi fi-us"></span>
                EN
              </a>
              <a class="btn btn-outline-primary btn-sm" href="{% if jekyll.environment == 'production' %}{{ site.production.baseurl | append: "/cs" }}{% else %}{{ site.development.baseurl | append: "/cs" }}{% endif %}">
                <span class="fi fi-cz"></span>
                CS
              </a>
            {% else %}
              <a class="btn btn-outline-primary btn-sm" href="{% if jekyll.environment == 'production' %}{{ site.production.baseurl | append: page.handle }}{% else %}{{ site.development.baseurl | append: page.handle }}{% endif %}">
                <span class="fi fi-gb"></span>
                <span class="fi fi-us"></span>
                EN
              </a>
              <a class="btn btn-outline-primary btn-sm" href="{% if jekyll.environment == 'production' %}{{ site.production.baseurl | append: "/cs" | append: page.handle }}{% else %}{{ site.development.baseurl | append: "/cs" | append: page.handle }}{% endif %}">
                <span class="fi fi-cz"></span>
                CS
              </a>
            {% endif %}
          </div>
        </div>
      {%- endif -%}
    </div>
  </nav>
</header>
